<!doctype html>
<html><head><meta charset="utf-8"><title>Reset Password</title></head><body>
<h2>Reset Password</h2>
<p>Enter new password (min 8 characters)</p>
<input id="token" placeholder="token" style="width:400px"><br>
<input id="newpass" type="password" placeholder="new password" style="width:400px"><br>
<button onclick="reset()">Reset</button>
<div id="res"></div>
<script>
  async function reset(){
    const token = document.getElementById('token').value;
    const password = document.getElementById('newpass').value;
    if (!token || !password) { document.getElementById('res').innerText = 'Token and password required'; return; }
    if (password.length < 8) { document.getElementById('res').innerText = 'Password must be at least 8 characters'; return; }
    const r = await fetch('/api/reset-password', {method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({token, password})});
    const j = await r.json();
    if (j.ok) {
      document.getElementById('res').innerText = 'Password reset successful. You can now login.';
    } else {
      document.getElementById('res').innerText = 'Error: ' + (j.error || JSON.stringify(j));
    }
  }
  const urlParams = new URLSearchParams(window.location.search);
  if (urlParams.get('token')) document.getElementById('token').value = urlParams.get('token');
</script></body></html>
